---
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const endpoint = "https://yvsqeurljhxwfykzgfyb.supabase.co/rest/v1/Toki?select=*";
  const key = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl2c3FldXJsamh4d2Z5a3pnZnliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5Nzc0ODMsImV4cCI6MjA3ODU1MzQ4M30.tQHxzSel-Iqvcvuh9XBVKsvHr-oNSd8XLUyhsGABUGo`;

  const options = {
    method: "GET",
    headers: {
      apikey: key,
    },
  };
  const response = await fetch(endpoint, options);
  const data = await response.json();

  return data.map((post) => {
    return {
      params: { id: post.id },
      props: { post },
    };
  });
}

const { id } = Astro.params;
const { post } = Astro.props;
---

<!-- indhold til undersiderne -->
<Layout>
  <section class="case">
    <div class="case-grid">
      <div class="case-img">
        <img src=`https://yvsqeurljhxwfykzgfyb.supabase.co/storage/v1/object/public/Toki_images/${post.image}` alt="case image" />
      </div>
      <div class="case-content">
        <h1>{post.casename}</h1>
        <div class="case-block">
          <h2>THE PROBLEM</h2>
          <p>{post.problem}</p>
        </div>
        <div class="case-block">
          <h2>SOLUTION</h2>
          <p>{post.solution}</p>
        </div>
        <div class="case-block">
          <h2>RESULTS</h2>
          <p>{post.results}</p>
        </div>
        <div class="case-icons">
          <img src="../public/ikoner.png" alt="icons" />
        </div>
      </div>
    </div>
  </section>
  <section class="related">
    <h2>RELATED CASES</h2>
    <div class="related-wrapper">
      <button class="arrow left">
        <img src="../public/pil_left.png" alt="arrow left" />
      </button>
      <div class="related-grid">
        <div class="related-item">
          <img src="../public/case1_image.webp" alt="case 1 image" />
        </div>
        <div class="related-item">
          <img src="../public/case2_image.webp" alt="case 2 image" />
        </div>
        <div class="related-item">
          <img src="../public/case3_image.webp" alt="case 3 image" />
        </div>
      </div>
      <button class="arrow right">
        <img src="../public/pil_right.png" alt="arrow right" />
      </button>
    </div>
  </section>
</Layout>

<style>
  .case {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 4rem;
  }
  h1 {
    font-size: clamp(2.5rem, 2vw, 2.4rem);
    margin-bottom: 1rem;
  }
  h2 {
    font-size: 1.5rem;
    margin-bottom: 0.4rem;
  }
  /* grid*/
  .case-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: start;
  }

  .case-img img {
    width: 100%;
    display: block;
    border-radius: 6px;
  }

  .case-content {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }
  .case-block p {
    line-height: 1.6;
  }
  /* related cases*/
  .related-wrapper {
    padding: 0 3rem; /* 3rem på hver side = pilene længere væk fra kanten */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2rem;
  }
  .arrow {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
  }

  .arrow img {
    width: 40px; /* gør pilens størrelse præcis */
    height: auto;
    opacity: 0.7; /* let dæmpning som i dit layout */
    transition: 0.2s ease;
  }

  .arrow:hover img {
    opacity: 1;
    transform: scale(1.1);
  }
  .related {
    text-align: center;
  }

  .related-grid {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  .related-item img {
    width: 80%;
    margin: 0 auto;
    display: block;
    border-radius: 6px;
  }
  /* responsiv */
  @media (max-width: 900px) {
    .case-grid {
      grid-template-columns: 1fr;
      text-align: center;
    }

    .case-icons img {
      margin: 0 auto;
    }
  }

  @media (max-width: 600px) {
    .case {
      padding: 3rem 0;
    }

    .case-content {
      gap: 1.5rem;
    }
  }
  @media (max-width: 700px) {
    .related-wrapper {
      flex-direction: column;
      gap: 1rem;
    }

    .arrow {
      order: -1;
    }
  }
</style>
